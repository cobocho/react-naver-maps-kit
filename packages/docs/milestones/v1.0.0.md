# v1.0.0 Milestone - Structure First

## Goal

`react-naver-maps-kit`를 v1 공개 전까지 안정적인 폴더 구조와 API 경계를 먼저 확정하고,
그 위에 로더/React API/오버레이를 단계적으로 구현한다.

## Core Principle

- 기능 구현보다 먼저 구조를 고정한다.
- public API는 `src/index.ts`에서만 노출한다.
- `@types/navermaps`는 전역 ambient 타입으로 사용하고, runtime SDK 로딩은 `core/loader`에서만 처리한다.

## Target Source Layout (v1 baseline)

```text
src/
  core/
    loader/
      loadNaverMapsScript.ts
    runtime/
      browser.ts
      errors.ts
  react/
    provider/
      NaverMapProvider.tsx
    hooks/
      useNaverMap.ts
    components/
      NaverMap.tsx
  overlays/
    marker/
      Marker.tsx
      CustomMarker.tsx
    infowindow/
      InfoWindow.tsx
  types/
    public.ts
    internal.ts
  utils/
    mapOptions.ts
    eventBinding.ts
  index.ts
```

## Exit Criteria

- 구조 이슈(Phase 1) 완료 전에는 기능 이슈 머지 금지
- 로더/React/오버레이가 디렉터리 경계를 넘지 않고 동작
- `pnpm lint`, `pnpm typecheck`, `pnpm build` green
- 문서에 아키텍처 경계와 import rule이 명시됨

## Phase Plan

### Phase 1 - Foundation (Must First)

- [ ] 폴더 구조 생성 및 책임 경계 문서화
- [ ] 기존/신규 파일을 구조에 맞게 배치
- [ ] `src/index.ts`에서만 public export하도록 정리
- [ ] import rule 정의 (예: `react/*`가 `core/*` 사용 가능, 역방향 금지)

### Phase 2 - Runtime Loader

- [ ] `ncpKeyId` 우선 로더 구현
- [ ] legacy key(`ncpClientId`, `govClientId`, `finClientId`) 하위호환 지원
- [ ] 중복 로딩 Promise dedupe
- [ ] timeout / error 표준화
- [ ] SSR-safe 가드

### Phase 3 - React Core API

- [ ] `NaverMapProvider`
- [ ] `NaverMap`
- [ ] `useNaverMap`
- [ ] map lifecycle(create/update/destroy)

### Phase 4 - Overlay API

- [ ] `Marker` wrapper
- [ ] children 기반 custom marker
- [ ] `InfoWindow` wrapper
- [ ] overlay cleanup

### Phase 5 - Events / Types / Docs

- [ ] 이벤트 바인딩 유틸 (`naver.maps.Event`) 정리
- [ ] public type contract 확정 (`types/public.ts`)
- [ ] quick start / submodule / troubleshooting 문서 작성

### Phase 6 - Release

- [ ] changelog 작성
- [ ] migration note(v0.x -> v1)
- [ ] `1.0.0` tag + release + npm publish

## Suggested Labels

- `infra`, `feature`, `docs`, `test`, `breaking`, `submodule`, `phase:1` ~ `phase:6`

## Suggested Milestone Rule

- 모든 이슈는 `v1.0.0`에 연결
- `phase:1` 이슈가 끝나기 전 `phase:2+` 기능 PR merge 금지
